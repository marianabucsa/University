<!DOCTYPE html>
<html>

<head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
</head>

<body>
  <table id="tabelJoc" border="1">
  </table>
  <script>
    var randomList;
    var n;
    var x;
    var y;
    $(function () {
      selectN()
    });

    function selectN() {
      var txt;
      n = prompt("Enter dimension: ", "");
      document.getElementById('tabelJoc').innerHTML = '';
      if (n == null || n === "" || isNaN(n) || parseInt(n) < 2) {
        txt = "Invalid dimension"
      } else {
        txt = parseInt(n);
        createTable();
      }
      document.getElementById("dim").innerHTML = 'Dimensiune: ' + txt;
    }

    function shuffle(a) {
      var j, x, i;
      for (i = 0; i < a.lenght; i++) {
        j = Math.floor(Math.random() * (i + 1));
        x = a[i];
        a[i] = a[j];
        a[j] = x;
      }
      return a;
    }

    function createTable() {
      var body = document.getElementsByTagName('body')[0];
      var tbl = document.getElementById('tabelJoc');
      //document.removeEventListener('keydown', keyPress);
      document.addEventListener('keydown', keyPress, false);
      tbl.setAttribute('border', '1');
      var tbdy = document.createElement('tbody');
      var cnt = 0;
      var list = [];
      for (var i = 0; i < n * n - 1; i++) {
        list.push(i + 1);
      }
      for (var i = 0; i < n; i++) {
        var tr = document.createElement('tr');
        for (var j = 0; j < n; j++) {
          var td = document.createElement('td');
          td.id = i + ',' + j;
          td.appendChild(document.createTextNode('\u0020'));
          var dim = 425 / n;
          td.style.width = dim + 'px';
          td.style.height = dim + 'px';
          td.style.textAlign = 'center';
          cnt = cnt + 1;
          if (cnt !== n * n) {
            td.style.background = ' url(monalisa.png) no-repeat';
            td.style.backgroundPosition = (-dim * j) + 'px ' + (-dim * i) + 'px';
          }
          tr.appendChild(td);
        }
        tbdy.appendChild(tr);

      }
      x = n - 1;
      y = n - 1;
      tbl.appendChild(tbdy);
      body.appendChild(tbl)
    }

    function int2string(x, y) {
      return x + ',' + y;
    }

    function string2int(str) {
      return [parseInt(str.split(',')[0]), parseInt(str.split(',')[1])];
    }

    function keyPress(event) {

      var code = event.charCode || event.keyCode;
      var name = String.fromCharCode(x);

      var currentTd = document.getElementById(int2string(x, y));
      if (code === 37 && y - 1 >= 0) { // left
        y = y - 1;
      } else if (code === 38 && x - 1 >= 0) { // up
        x = x - 1;
      } else if (code === 39 && y + 1 < n) { // right
        y = y + 1;
      } else if (code === 40 && x + 1 < n) { // down
        x = x + 1;
      }
      var newTd = document.getElementById(int2string(x, y));
      currentTd.style.background = ' url(monalisa.png) no-repeat';
      currentTd.style.backgroundPosition = newTd.style.backgroundPosition;
      newTd.style.background = "";
    }
  </script>
</body>

</html>